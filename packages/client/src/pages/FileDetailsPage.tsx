import { useNavigate } from 'react-router-dom';
import { useState } from 'react';
import './FileDetailsPage.css';

const BackIcon = () => (
  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
    <path d="M19 12H5M12 19l-7-7 7-7"/>
  </svg>
);

const OpenIcon = () => (
  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
    <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
    <polyline points="15 3 21 3 21 9"></polyline>
    <line x1="10" y1="14" x2="21" y2="3"></line>
  </svg>
);

const BookmarkIcon = () => (
  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
    <path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"></path>
  </svg>
);

const ShareIcon = () => (
  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
    <circle cx="18" cy="5" r="3"></circle>
    <circle cx="6" cy="12" r="3"></circle>
    <circle cx="18" cy="19" r="3"></circle>
    <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line>
    <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line>
  </svg>
);

const DownloadIcon = () => (
  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
    <polyline points="7 10 12 15 17 10"></polyline>
    <line x1="12" y1="15" x2="12" y2="3"></line>
  </svg>
);

const LineageIcon = () => (
  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
    <circle cx="18" cy="18" r="3"></circle>
    <circle cx="6" cy="6" r="3"></circle>
    <path d="M13 6h3a2 2 0 0 1 2 2v7"></path>
    <line x1="6" y1="9" x2="6" y2="21"></line>
  </svg>
);

const HistoryIcon = () => (
  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
    <circle cx="12" cy="12" r="10"></circle>
    <polyline points="12 6 12 12 16 14"></polyline>
  </svg>
);

const MoreIcon = () => (
  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
    <circle cx="12" cy="12" r="1"></circle>
    <circle cx="12" cy="5" r="1"></circle>
    <circle cx="12" cy="19" r="1"></circle>
  </svg>
);

const CloseIcon = () => (
  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
    <line x1="18" y1="6" x2="6" y2="18"></line>
    <line x1="6" y1="6" x2="18" y2="18"></line>
  </svg>
);

const CopyIcon = () => (
  <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M13.3333 6H7.33333C6.59695 6 6 6.59695 6 7.33333V13.3333C6 14.0697 6.59695 14.6667 7.33333 14.6667H13.3333C14.0697 14.6667 14.6667 14.0697 14.6667 13.3333V7.33333C14.6667 6.59695 14.0697 6 13.3333 6Z" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round"/>
    <path d="M3.33333 10H2.66667C2.31304 10 1.97391 9.85952 1.72386 9.60947C1.47381 9.35942 1.33333 9.02029 1.33333 8.66667V2.66667C1.33333 2.31304 1.47381 1.97391 1.72386 1.72386C1.97391 1.47381 2.31304 1.33333 2.66667 1.33333H8.66667C9.02029 1.33333 9.35942 1.47381 9.60947 1.72386C9.85952 1.97391 10 2.31304 10 2.66667V3.33333" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round"/>
  </svg>
);

const CheckIcon = () => (
  <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M13.3333 4L6 11.3333L2.66667 8" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
  </svg>
);

function FileDetailsPage() {
  const navigate = useNavigate();
  const [showHistory, setShowHistory] = useState(false);
  const [copiedId, setCopiedId] = useState<string | null>(null);

  const handleCopy = (text: string, id: string) => {
    navigator.clipboard.writeText(text);
    setCopiedId(id);
    setTimeout(() => setCopiedId(null), 2000);
  };

  return (
    <div className="file-details-page">
      <div className="back-button-container">
        <button className="back-button" onClick={() => navigate(-1)}>
          <BackIcon />
          <span>Back</span>
        </button>
      </div>
      <div className="file-details-content">
        <div className="file-details-main">
          <div className="file-details-left">
            <div className="attributes-section">
              <h3>Attributes</h3>
              <div className="attribute-item">
                <div className="attribute-value">Proteomics Study 3</div>
                <div className="attribute-label">Study Name</div>
                <button className="copy-btn" onClick={() => handleCopy('Proteomics Study 3', 'attr-study-name')}>
                  {copiedId === 'attr-study-name' ? <CheckIcon /> : <CopyIcon />}
                </button>
              </div>
              <div className="attribute-item">
                <div className="attribute-value">Protocol</div>
                <div className="attribute-label">Document Type</div>
                <button className="copy-btn" onClick={() => handleCopy('Protocol', 'attr-doc-type')}>
                  {copiedId === 'attr-doc-type' ? <CheckIcon /> : <CopyIcon />}
                </button>
              </div>
              <div className="attribute-item">
                <div className="attribute-value">Dr. Sarah Chen</div>
                <div className="attribute-label">Principal Investigator</div>
                <button className="copy-btn" onClick={() => handleCopy('Dr. Sarah Chen', 'attr-pi')}>
                  {copiedId === 'attr-pi' ? <CheckIcon /> : <CopyIcon />}
                </button>
              </div>
            </div>

            <div className="information-section">
              <h3>Information</h3>
              <div className="info-item">
                <div className="info-value">Proteomics-Study3-Protocol.txt</div>
                <div className="info-label">File Name</div>
                <button className="copy-btn" onClick={() => handleCopy('Proteomics-Study3-Protocol.txt', 'info-file-name')}>
                  {copiedId === 'info-file-name' ? <CheckIcon /> : <CopyIcon />}
                </button>
              </div>
              <div className="info-item">
                <div className="info-value">file-ps3-001</div>
                <div className="info-label">File ID</div>
                <button className="copy-btn" onClick={() => handleCopy('file-ps3-001', 'info-file-id')}>
                  {copiedId === 'info-file-id' ? <CheckIcon /> : <CopyIcon />}
                </button>
              </div>
              <div className="info-item">
                <div className="info-value">/tetrasphere/proteomics/study-3/docs</div>
                <div className="info-label">File Path</div>
                <button className="copy-btn" onClick={() => handleCopy('/tetrasphere/proteomics/study-3/docs', 'info-file-path')}>
                  {copiedId === 'info-file-path' ? <CheckIcon /> : <CopyIcon />}
                </button>
              </div>
              <div className="info-item">
                <div className="info-value">/tetrasphere/proteomics/study-3/docs</div>
                <div className="info-label">Source Location</div>
                <button className="copy-btn" onClick={() => handleCopy('/tetrasphere/proteomics/study-3/docs', 'info-source-location')}>
                  {copiedId === 'info-source-location' ? <CheckIcon /> : <CopyIcon />}
                </button>
              </div>
              <div className="info-item">
                <div className="info-value">01/09/2026, 04:30:00 PM EST</div>
                <div className="info-label">Upload date</div>
                <button className="copy-btn" onClick={() => handleCopy('01/09/2026, 04:30:00 PM EST', 'info-upload-date')}>
                  {copiedId === 'info-upload-date' ? <CheckIcon /> : <CopyIcon />}
                </button>
              </div>
              <div className="info-item">
                <div className="info-value">Text Document</div>
                <div className="info-label">Source Type</div>
                <button className="copy-btn" onClick={() => handleCopy('Text Document', 'info-source-type')}>
                  {copiedId === 'info-source-type' ? <CheckIcon /> : <CopyIcon />}
                </button>
              </div>
              <div className="info-item">
                <div className="info-value">18.5 KB</div>
                <div className="info-label">Size</div>
                <button className="copy-btn" onClick={() => handleCopy('18.5 KB', 'info-size')}>
                  {copiedId === 'info-size' ? <CheckIcon /> : <CopyIcon />}
                </button>
              </div>
            </div>
          </div>

          <div className="file-details-right">
            <div className="preview-section">
              <div className="preview-header">
                <h3>Preview</h3>
                <div className="preview-actions">
                  <button className="preview-action-btn">
                    <OpenIcon />
                    <span>Open</span>
                  </button>
                  <button className="preview-action-btn">
                    <BookmarkIcon />
                    <span>Bookmark</span>
                  </button>
                  <button className="preview-action-btn">
                    <ShareIcon />
                    <span>Share</span>
                  </button>
                  <button className="preview-action-btn">
                    <DownloadIcon />
                    <span>Download</span>
                  </button>
                  <button className="preview-action-btn">
                    <LineageIcon />
                    <span>Lineage</span>
                  </button>
                  <button className="preview-action-btn" onClick={() => setShowHistory(!showHistory)}>
                    <HistoryIcon />
                    <span>History</span>
                  </button>
                  <button className="preview-action-btn">
                    <MoreIcon />
                  </button>
                </div>
              </div>
              <div className="preview-content">
                <button className="preview-copy-btn" onClick={() => handleCopy('Proteomics-Study3-Protocol.txt', 'preview-copy')}>
                  {copiedId === 'preview-copy' ? <CheckIcon /> : <CopyIcon />}
                </button>
                <div className="preview-title"># Proteomics Study 3 - Experimental Protocol</div>
                <div className="preview-text">
                  <p className="separator">================================================================================</p>
                  <p><strong>PROTEOMICS STUDY 3: COMPARATIVE PROTEIN EXPRESSION ANALYSIS</strong></p>
                  <p className="separator">================================================================================</p>
                  <p>&nbsp;</p>
                  <p><strong>STUDY INFORMATION</strong></p>
                  <p>-----------</p>
                  <p>Study ID: PS3-2026-001</p>
                  <p>Principal Investigator: Dr. Sarah Chen</p>
                  <p>Lab: Proteomics Research Center</p>
                  <p>Institution: TetraScience Molecular Biology Institute</p>
                  <p>Protocol Version: 2.1</p>
                  <p>Date Created: 01/05/2026</p>
                  <p>Last Modified: 01/09/2026</p>
                  <p>Status: Active</p>
                  <p>&nbsp;</p>
                  <p><strong>STUDY OBJECTIVE:</strong></p>
                  <p>-----------</p>
                  <p>To perform comprehensive proteomic profiling of cancer cell lines treated with</p>
                  <p>experimental therapeutic compound TS-3847 compared to vehicle controls. This study</p>
                  <p>aims to identify differentially expressed proteins and elucidate the molecular</p>
                  <p>mechanisms of action for this novel anti-cancer agent. The proteomics data will</p>
                  <p>inform downstream pathway analysis and identify potential biomarkers for clinical</p>
                  <p>development.</p>
                  <p>&nbsp;</p>
                  <p><strong>SAMPLE INFORMATION:</strong></p>
                  <p>-----------</p>
                  <p>Cell Line: A549 (human lung carcinoma)</p>
                  <p>Source: ATCC CCL-185</p>
                  <p>Passage Range: P15-P20</p>
                  <p>Culture Medium: RPMI-1640 + 10% FBS + 1% Pen/Strep</p>
                  <p>Sample Groups:</p>
                  <p>  - Group A: Vehicle Control (DMSO 0.1%) - 6 biological replicates</p>
                  <p>  - Group B: TS-3847 Treatment (10µM) - 6 biological replicates</p>
                  <p>Total Samples: 12</p>
                  <p>&nbsp;</p>
                  <p><strong>MATERIALS AND REAGENTS:</strong></p>
                  <p>-----------</p>
                  <p>Reagents:</p>
                  <p>  - TS-3847 compound (10mM stock in DMSO)</p>
                  <p>  - DMSO (molecular biology grade)</p>
                  <p>  - RIPA lysis buffer (Thermo Fisher #89900)</p>
                  <p>  - Protease inhibitor cocktail (Roche cOmplete Mini)</p>
                  <p>  - Phosphatase inhibitor cocktail (Sigma PhosSTOP)</p>
                  <p>  - BCA protein assay kit (Pierce #23225)</p>
                  <p>  - Trypsin/Lys-C mix (Promega V5073)</p>
                  <p>  - TMT 11-plex isobaric labeling kit (Thermo Fisher #A34808)</p>
                  <p>  - C18 Sep-Pak cartridges (Waters WAT054955)</p>
                  <p>  - Acetonitrile (LC-MS grade)</p>
                  <p>  - Formic acid (LC-MS grade)</p>
                  <p>&nbsp;</p>
                  <p>Equipment:</p>
                  <p>  - Orbitrap Fusion Lumos Tribrid Mass Spectrometer (Thermo Fisher)</p>
                  <p>  - EASY-nLC 1200 UHPLC system (Thermo Fisher)</p>
                  <p>  - Acclaim PepMap RSLC C18 column (75µm x 50cm, 2µm particles)</p>
                  <p>  - Centrifuge (Eppendorf 5424R)</p>
                  <p>  - SpeedVac concentrator (Thermo Savant)</p>
                  <p>  - pH meter</p>
                  <p>  - Vortex mixer</p>
                  <p>  - -80°C freezer</p>
                  <p>&nbsp;</p>
                  <p><strong>EXPERIMENTAL PROCEDURE:</strong></p>
                  <p>-----------</p>
                  <p>&nbsp;</p>
                  <p>Day 1 - Cell Culture and Treatment:</p>
                  <p>1. Seed A549 cells at 2x10^6 cells per 10cm dish</p>
                  <p>2. Culture overnight in RPMI-1640 + 10% FBS at 37°C, 5% CO2</p>
                  <p>3. Verify cell confluency reaches 70-80%</p>
                  <p>4. Prepare treatment solutions:</p>
                  <p>   - Vehicle control: DMSO diluted to 0.1% in culture medium</p>
                  <p>   - TS-3847 treatment: 10µM final concentration in culture medium</p>
                  <p>5. Replace medium with treatment solutions (10mL per dish)</p>
                  <p>6. Incubate for 48 hours</p>
                  <p>&nbsp;</p>
                  <p>Day 3 - Cell Harvest and Lysis:</p>
                  <p>1. Remove culture medium and wash cells 3x with ice-cold PBS</p>
                  <p>2. Add 500µL RIPA buffer + protease/phosphatase inhibitors per dish</p>
                  <p>3. Scrape cells and transfer to pre-chilled 1.5mL tubes</p>
                  <p>4. Incubate on ice for 30 minutes with vortexing every 10 min</p>
                  <p>5. Centrifuge at 14,000 x g for 15 min at 4°C</p>
                  <p>6. Transfer supernatant to fresh tubes, discard pellet</p>
                  <p>7. Measure protein concentration using BCA assay</p>
                  <p>8. Normalize all samples to 2 mg/mL</p>
                  <p>9. Aliquot 100µg protein per sample, store at -80°C</p>
                  <p>&nbsp;</p>
                  <p>Day 4 - Protein Digestion:</p>
                  <p>1. Thaw protein samples on ice</p>
                  <p>2. Reduce disulfide bonds with 5mM DTT at 56°C for 30 min</p>
                  <p>3. Alkylate cysteines with 15mM iodoacetamide at RT for 30 min in dark</p>
                  <p>4. Quench with additional 5mM DTT</p>
                  <p>5. Add trypsin/Lys-C mix at 1:50 enzyme:protein ratio</p>
                  <p>6. Digest overnight at 37°C with gentle shaking</p>
                  <p>7. Quench digestion with 1% formic acid</p>
                  <p>8. Desalt peptides using C18 Sep-Pak cartridges</p>
                  <p>9. Dry peptides in SpeedVac</p>
                  <p>&nbsp;</p>
                  <p>Day 5 - TMT Labeling:</p>
                  <p>1. Reconstitute peptides in 100µL of 100mM TEAB buffer</p>
                  <p>2. Label samples with TMT 11-plex reagents according to scheme:</p>
                  <p>   - TMT-126: Control replicate 1</p>
                  <p>   - TMT-127N: Control replicate 2</p>
                  <p>   - TMT-127C: Control replicate 3</p>
                  <p>   - TMT-128N: Control replicate 4</p>
                  <p>   - TMT-128C: Control replicate 5</p>
                  <p>   - TMT-129N: Control replicate 6</p>
                  <p>   - TMT-129C: Treatment replicate 1</p>
                  <p>   - TMT-130N: Treatment replicate 2</p>
                  <p>   - TMT-130C: Treatment replicate 3</p>
                  <p>   - TMT-131N: Treatment replicate 4</p>
                  <p>   - TMT-131C: Treatment replicate 5</p>
                  <p>3. Incubate at RT for 1 hour</p>
                  <p>4. Quench with 5% hydroxylamine for 15 min</p>
                  <p>5. Combine all labeled samples into one tube</p>
                  <p>6. Desalt and dry in SpeedVac</p>
                  <p>&nbsp;</p>
                  <p>Day 6 - LC-MS/MS Analysis:</p>
                  <p>1. Reconstitute peptides in 0.1% formic acid</p>
                  <p>2. Load 2µg peptides onto Acclaim PepMap trap column</p>
                  <p>3. Separate on 50cm C18 analytical column using 180 min gradient:</p>
                  <p>   - 0-5 min: 3% B</p>
                  <p>   - 5-140 min: 3-28% B</p>
                  <p>   - 140-160 min: 28-40% B</p>
                  <p>   - 160-165 min: 40-80% B</p>
                  <p>   - 165-170 min: 80% B</p>
                  <p>   - 170-180 min: 3% B (re-equilibration)</p>
                  <p>   Mobile phase A: 0.1% formic acid in water</p>
                  <p>   Mobile phase B: 0.1% formic acid in 80% acetonitrile</p>
                  <p>4. MS parameters (Orbitrap Fusion Lumos):</p>
                  <p>   - MS1 scan: 120,000 resolution, 400-1600 m/z, AGC 4e5, 50ms max IT</p>
                  <p>   - MS2 scan: CID fragmentation, 35% collision energy</p>
                  <p>   - MS3 scan: HCD fragmentation for TMT quantification</p>
                  <p>   - Top speed mode with 3 second cycle time</p>
                  <p>&nbsp;</p>
                  <p><strong>DATA ANALYSIS:</strong></p>
                  <p>-----------</p>
                  <p>1. Raw data processing with Proteome Discoverer 2.5</p>
                  <p>2. Database search against UniProt human proteome (reviewed entries)</p>
                  <p>3. Search parameters:</p>
                  <p>   - Enzyme: Trypsin, max 2 missed cleavages</p>
                  <p>   - Fixed modifications: Carbamidomethyl (C), TMT6plex (N-term, K)</p>
                  <p>   - Variable modifications: Oxidation (M), Acetyl (Protein N-term)</p>
                  <p>   - Precursor mass tolerance: 10 ppm</p>
                  <p>   - Fragment mass tolerance: 0.6 Da</p>
                  <p>   - FDR: 1% at peptide and protein level</p>
                  <p>4. Statistical analysis in Perseus software</p>
                  <p>5. Pathway enrichment analysis using DAVID and STRING</p>
                  <p>&nbsp;</p>
                  <p><strong>EXPECTED DELIVERABLES:</strong></p>
                  <p>-----------</p>
                  <p>1. Raw MS data files (.raw format) - 12 files</p>
                  <p>2. Processed peptide identification files (.msf)</p>
                  <p>3. Protein quantification matrix (Excel)</p>
                  <p>4. Quality control report (PDF)</p>
                  <p>5. Differential expression analysis results</p>
                  <p>6. Pathway enrichment analysis results</p>
                  <p>7. Final study report with figures</p>
                  <p>&nbsp;</p>
                  <p><strong>DATA STORAGE:</strong></p>
                  <p>-----------</p>
                  <p>Raw data: /tetrasphere/proteomics/study-3/samples/</p>
                  <p>Processed data: /tetrasphere/proteomics/study-3/processed/</p>
                  <p>Analysis results: /tetrasphere/proteomics/study-3/analysis/</p>
                  <p>Documentation: /tetrasphere/proteomics/study-3/docs/</p>
                  <p>&nbsp;</p>
                  <p><strong>TIMELINE:</strong></p>
                  <p>-----------</p>
                  <p>Sample preparation: 01/06/2026 - 01/08/2026</p>
                  <p>MS data acquisition: 01/10/2026 - 01/12/2026</p>
                  <p>Data analysis: 01/13/2026 - 01/20/2026</p>
                  <p>Report generation: 01/21/2026 - 01/25/2026</p>
                  <p>&nbsp;</p>
                  <p className="separator">================================================================================</p>
                  <p>End of Protocol Document</p>
                  <p className="separator">================================================================================</p>
                </div>
              </div>
            </div>
          </div>
        </div>

        {showHistory && (
          <div className="history-sidebar">
            <div className="history-header">
              <h3>History</h3>
              <button className="close-history-btn" onClick={() => setShowHistory(false)}>
                <CloseIcon />
              </button>
            </div>

            <div className="history-content">
              <h4>All versions</h4>
              <div className="version-item">
                <div className="version-info">
                  <div className="version-name">Proteomics-Study3-Protocol-v2.1.txt</div>
                  <div className="version-meta">01/09/2026 4:30 PM</div>
                </div>
                <button className="download-version-btn">
                  <DownloadIcon />
                </button>
              </div>

              <h4>Related files</h4>
              <div className="related-section">
                <h5>Sample Data Files</h5>
                <div className="related-file">
                  <div className="related-file-name">Proteomics-Study3-Sample-A1.raw</div>
                  <div className="related-file-type">MS Data File</div>
                  <button className="copy-btn" onClick={() => handleCopy('Proteomics-Study3-Sample-A1.raw', 'related-sample-1')}>
                    {copiedId === 'related-sample-1' ? <CheckIcon /> : <CopyIcon />}
                  </button>
                </div>
                <div className="related-file">
                  <div className="related-file-name">Proteomics-Study3-Sample-A2.raw</div>
                  <div className="related-file-type">MS Data File</div>
                  <button className="copy-btn" onClick={() => handleCopy('Proteomics-Study3-Sample-A2.raw', 'related-sample-2')}>
                    {copiedId === 'related-sample-2' ? <CheckIcon /> : <CopyIcon />}
                  </button>
                </div>
                <div className="related-file">
                  <div className="related-file-name">Proteomics-Study3-Control-C1.raw</div>
                  <div className="related-file-type">MS Data File</div>
                  <button className="copy-btn" onClick={() => handleCopy('Proteomics-Study3-Control-C1.raw', 'related-control-1')}>
                    {copiedId === 'related-control-1' ? <CheckIcon /> : <CopyIcon />}
                  </button>
                </div>
              </div>

              <div className="related-section">
                <h5>Metadata</h5>
                <div className="related-file">
                  <div className="related-file-name">Proteomics-Study3-Metadata.csv</div>
                  <div className="related-file-type">Metadata File</div>
                  <button className="copy-btn" onClick={() => handleCopy('Proteomics-Study3-Metadata.csv', 'related-metadata')}>
                    {copiedId === 'related-metadata' ? <CheckIcon /> : <CopyIcon />}
                  </button>
                </div>
              </div>
            </div>
          </div>
        )}
      </div>
    </div>
  );
}

export default FileDetailsPage;

